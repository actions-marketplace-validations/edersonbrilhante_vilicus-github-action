name: 'Vilicus Scan'
description: 'Scans container images for vulnerabilities using Vilicus'
author: 'Ederson Brilhante'
inputs:
  image:
    description: 'image reference'
    required: true
  template:
    description: 'template output'
    required: false
    default: /opt/vilicus/contrib/sarif.tpl
  config:
    description: 'config file'
    required: false
    default: /opt/vilicus/configs/conf.yaml
  output:
    description: 'output file name'
    required: false
    default: results.sarif
outputs:
  file:
    description: "output file with path"
    value: ${{ steps.scan.outputs.output-file }}
runs:
  using: "composite"
  steps:
    - id: scan
      run: |
        echo "::set-output name=output-file::$(echo ${{ github.action_path }}/artifacts/${{ inputs.output }})"
      env:
        IMAGE: ${{ inputs.image }}
        TEMPLATE: ${{ inputs.template }}
        CONFIG: ${{ inputs.config }}
        OUTPUT: /artifacts/${{ inputs.output }}
      shell: bash
branding:
  icon: 'shield'
  color: 'green'